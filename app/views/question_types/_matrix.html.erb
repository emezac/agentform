<div class="space-y-4">
  <% rows = config['rows'] || [] %>
  <% columns = config['columns'] || [] %>
  <% input_type = config['multiple_selection'] == true ? 'checkbox' : 'radio' %>
  
  <% if rows.any? && columns.any? %>
    <div class="overflow-x-auto">
      <table class="min-w-full">
        <thead>
          <tr>
            <th class="text-left py-2 pr-4 text-sm font-medium text-gray-900"></th>
            <% columns.each do |column| %>
              <th class="text-center py-2 px-2 text-sm font-medium text-gray-900 min-w-20">
                <%= column['label'] || column %>
              </th>
            <% end %>
          </tr>
        </thead>
        <tbody class="space-y-2">
          <% rows.each_with_index do |row, row_index| %>
            <tr class="border-t border-gray-100">
              <td class="py-3 pr-4 text-sm text-gray-900 font-medium">
                <%= row['label'] || row %>
                <% if row.is_a?(Hash) && row['description'] %>
                  <div class="text-xs text-gray-500 mt-1"><%= row['description'] %></div>
                <% end %>
              </td>
              
              <% columns.each_with_index do |column, col_index| %>
                <td class="text-center py-3 px-2">
                  <% row_id = row['id'] || row_index %>
                  <% col_id = column['id'] || col_index %>
                  <% field_name = input_type == 'checkbox' ? "answer[#{row_id}][]" : "answer[#{row_id}]" %>
                  
                  <label class="inline-flex items-center justify-center cursor-pointer">
                    <% if input_type == 'checkbox' %>
                      <%= form.check_box field_name,
                                        { 
                                          multiple: true,
                                          class: "h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded",
                                          data: { 
                                            "question-response-target": "answerInput",
                                            "action": "change->question-response#validateInput"
                                          }
                                        },
                                        col_id,
                                        "" %>
                    <% else %>
                      <%= form.radio_button field_name,
                                          col_id,
                                          { 
                                            class: "h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300",
                                            data: { 
                                              "question-response-target": "answerInput",
                                              "action": "change->question-response#validateInput"
                                            }
                                          } %>
                    <% end %>
                  </label>
                </td>
              <% end %>
            </tr>
          <% end %>
        </tbody>
      </table>
    </div>
  <% else %>
    <div class="text-center py-8 text-gray-500">
      <p class="text-sm">Matrix configuration is incomplete.</p>
      <p class="text-xs mt-1">Please configure rows and columns in the question settings.</p>
    </div>
  <% end %>
  
  <% if config['help_text'] %>
    <p class="text-xs text-gray-500"><%= config['help_text'] %></p>
  <% end %>
  
  <% if config['multiple_selection'] == true %>
    <p class="text-xs text-gray-500">
      You can select multiple options for each row.
    </p>
  <% else %>
    <p class="text-xs text-gray-500">
      Select one option for each row.
    </p>
  <% end %>
</div>