<% content_for :title, "AI Form Generated Successfully" %>

<div class="container mx-auto px-4 py-8">
  <div class="max-w-4xl mx-auto">
    <!-- Success Header -->
    <div class="text-center mb-8">
      <div class="w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4">
        <svg class="w-8 h-8 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
        </svg>
      </div>
      <h1 class="text-3xl font-bold text-gray-900 mb-2">Form Generated Successfully!</h1>
      <p class="text-lg text-gray-600">
        Your AI-powered form "<%= @form.name %>" has been created and is ready for customization.
      </p>
    </div>

    <!-- Generation Summary Card -->
    <div class="bg-gradient-to-r from-purple-50 to-indigo-50 rounded-2xl p-6 mb-8 border border-purple-100">
      <h2 class="text-xl font-semibold text-gray-900 mb-4 flex items-center">
        <svg class="w-6 h-6 text-purple-600 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2-2V7a2 2 0 012-2h2a2 2 0 002 2v2a2 2 0 002 2h2a2 2 0 002-2V7a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 00-2 2h-2a2 2 0 00-2 2v6a2 2 0 01-2 2H9z" />
        </svg>
        Generation Summary
      </h2>
      
      <div class="grid md:grid-cols-3 gap-6">
        <!-- Cost Information -->
        <div class="bg-white rounded-xl p-4 border border-purple-100">
          <div class="flex items-center justify-between mb-2">
            <span class="text-sm font-medium text-gray-600">AI Cost</span>
            <svg class="w-4 h-4 text-green-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1" />
            </svg>
          </div>
          <div class="text-2xl font-bold text-gray-900">
            $<%= number_with_precision(@form.metadata['ai_cost'] || 0.05, precision: 2) %>
          </div>
          <div class="text-xs text-gray-500">Deducted from your credits</div>
        </div>

        <!-- Questions Count -->
        <div class="bg-white rounded-xl p-4 border border-purple-100">
          <div class="flex items-center justify-between mb-2">
            <span class="text-sm font-medium text-gray-600">Questions</span>
            <svg class="w-4 h-4 text-blue-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
            </svg>
          </div>
          <div class="text-2xl font-bold text-gray-900">
            <%= @form.form_questions.count %>
          </div>
          <div class="text-xs text-gray-500">AI-generated questions</div>
        </div>

        <!-- Complexity Level -->
        <div class="bg-white rounded-xl p-4 border border-purple-100">
          <div class="flex items-center justify-between mb-2">
            <span class="text-sm font-medium text-gray-600">Complexity</span>
            <svg class="w-4 h-4 text-orange-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z" />
            </svg>
          </div>
          <div class="text-lg font-bold text-gray-900 capitalize">
            <%= @form.metadata.dig('content_analysis', 'complexity_level') || 'Moderate' %>
          </div>
          <div class="text-xs text-gray-500">Based on content analysis</div>
        </div>
      </div>
    </div>

    <!-- Form Preview and Actions -->
    <div class="grid lg:grid-cols-2 gap-8">
      <!-- Form Preview -->
      <div class="bg-white rounded-2xl shadow-lg border border-gray-200 overflow-hidden">
        <div class="bg-gray-50 px-6 py-4 border-b border-gray-200">
          <h3 class="text-lg font-semibold text-gray-900 flex items-center">
            <svg class="w-5 h-5 text-gray-600 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z" />
            </svg>
            Form Preview
          </h3>
        </div>
        
        <div class="p-6 max-h-96 overflow-y-auto">
          <!-- Form Header -->
          <div class="mb-6">
            <h2 class="text-xl font-bold text-gray-900 mb-2"><%= @form.name %></h2>
            <% if @form.description.present? %>
              <p class="text-gray-600"><%= @form.description %></p>
            <% end %>
          </div>

          <!-- Questions Preview -->
          <div class="space-y-4">
            <% @form.form_questions.order(:position).limit(5).each_with_index do |question, index| %>
              <div class="border border-gray-200 rounded-lg p-4">
                <div class="flex items-start justify-between mb-2">
                  <h4 class="font-medium text-gray-900 flex items-center">
                    <span class="w-6 h-6 bg-indigo-100 text-indigo-600 rounded-full flex items-center justify-center text-sm font-semibold mr-2">
                      <%= index + 1 %>
                    </span>
                    <%= question.title %>
                    <% if question.required? %>
                      <span class="text-red-500 ml-1">*</span>
                    <% end %>
                  </h4>
                  <% if question.ai_enhanced? %>
                    <div class="flex items-center space-x-1">
                      <div class="w-2 h-2 bg-purple-500 rounded-full"></div>
                      <span class="text-xs text-purple-600 font-medium">AI</span>
                    </div>
                  <% end %>
                </div>
                
                <% if question.description.present? %>
                  <p class="text-sm text-gray-600 mb-2"><%= question.description %></p>
                <% end %>
                
                <div class="text-xs text-gray-500 bg-gray-50 px-2 py-1 rounded">
                  <%= question.question_type.humanize %>
                </div>
              </div>
            <% end %>
            
            <% if @form.form_questions.count > 5 %>
              <div class="text-center py-4 text-gray-500">
                <span class="text-sm">... and <%= @form.form_questions.count - 5 %> more questions</span>
              </div>
            <% end %>
          </div>
        </div>
      </div>

      <!-- Actions and Recommendations -->
      <div class="space-y-6">
        <!-- Primary Actions -->
        <div class="bg-white rounded-2xl shadow-lg border border-gray-200 p-6">
          <h3 class="text-lg font-semibold text-gray-900 mb-4">What's Next?</h3>
          
          <div class="space-y-3">
            <%= link_to edit_form_path(@form), 
                class: "w-full flex items-center justify-center px-6 py-3 bg-gradient-to-r from-purple-600 to-indigo-600 text-white font-semibold rounded-xl hover:from-purple-700 hover:to-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 transition-all duration-200 shadow-lg hover:shadow-xl transform hover:-translate-y-0.5" do %>
              <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z" />
              </svg>
              Customize Your Form
            <% end %>
            
            <%= link_to preview_form_path(@form), 
                target: "_blank",
                class: "w-full flex items-center justify-center px-6 py-3 bg-white border-2 border-gray-300 text-gray-700 font-semibold rounded-xl hover:bg-gray-50 hover:border-gray-400 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2 transition-all duration-200" do %>
              <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z" />
              </svg>
              Preview Form
            <% end %>
            
            <%= link_to form_path(@form), 
                class: "w-full flex items-center justify-center px-6 py-3 bg-white border border-gray-300 text-gray-600 font-medium rounded-xl hover:bg-gray-50 hover:text-gray-700 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2 transition-all duration-200" do %>
              <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2-2V7a2 2 0 012-2h2a2 2 0 002 2v2a2 2 0 002 2h2a2 2 0 002-2V7a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 00-2 2h-2a2 2 0 00-2 2v6a2 2 0 01-2 2H9z" />
              </svg>
              View Form Details
            <% end %>
          </div>
        </div>

        <!-- AI Recommendations -->
        <% if @form.metadata.dig('content_analysis', 'recommendations').present? %>
          <div class="bg-gradient-to-r from-blue-50 to-indigo-50 rounded-2xl p-6 border border-blue-100">
            <h3 class="text-lg font-semibold text-gray-900 mb-3 flex items-center">
              <svg class="w-5 h-5 text-blue-600 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z" />
              </svg>
              AI Recommendations
            </h3>
            <div class="space-y-2">
              <% @form.metadata.dig('content_analysis', 'recommendations').each do |recommendation| %>
                <div class="flex items-start space-x-2">
                  <svg class="w-4 h-4 text-blue-600 mt-0.5 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                  </svg>
                  <span class="text-sm text-gray-700"><%= recommendation %></span>
                </div>
              <% end %>
            </div>
          </div>
        <% end %>

        <!-- AI Features Enabled -->
        <% if @form.ai_enabled? && @form.ai_configuration['features'].present? %>
          <div class="bg-white rounded-2xl shadow-lg border border-gray-200 p-6">
            <h3 class="text-lg font-semibold text-gray-900 mb-3 flex items-center">
              <svg class="w-5 h-5 text-purple-600 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z" />
              </svg>
              AI Features Enabled
            </h3>
            <div class="grid grid-cols-2 gap-2">
              <% @form.ai_configuration['features'].each do |feature| %>
                <div class="flex items-center space-x-2 text-sm">
                  <div class="w-2 h-2 bg-green-500 rounded-full"></div>
                  <span class="text-gray-700"><%= feature.humanize %></span>
                </div>
              <% end %>
            </div>
          </div>
        <% end %>

        <!-- Share Options -->
        <div class="bg-white rounded-2xl shadow-lg border border-gray-200 p-6">
          <h3 class="text-lg font-semibold text-gray-900 mb-3">Share Your Success</h3>
          <p class="text-sm text-gray-600 mb-4">
            Let others know about your AI-generated form!
          </p>
          <div class="flex space-x-2">
            <button class="flex-1 px-4 py-2 bg-blue-600 text-white text-sm font-medium rounded-lg hover:bg-blue-700 transition-colors"
                    onclick="shareOnTwitter()">
              <svg class="w-4 h-4 inline mr-1" fill="currentColor" viewBox="0 0 24 24">
                <path d="M23.953 4.57a10 10 0 01-2.825.775 4.958 4.958 0 002.163-2.723c-.951.555-2.005.959-3.127 1.184a4.92 4.92 0 00-8.384 4.482C7.69 8.095 4.067 6.13 1.64 3.162a4.822 4.822 0 00-.666 2.475c0 1.71.87 3.213 2.188 4.096a4.904 4.904 0 01-2.228-.616v.06a4.923 4.923 0 003.946 4.827 4.996 4.996 0 01-2.212.085 4.936 4.936 0 004.604 3.417 9.867 9.867 0 01-6.102 2.105c-.39 0-.779-.023-1.17-.067a13.995 13.995 0 007.557 2.209c9.053 0 13.998-7.496 13.998-13.985 0-.21 0-.42-.015-.63A9.935 9.935 0 0024 4.59z"/>
              </svg>
              Twitter
            </button>
            <button class="flex-1 px-4 py-2 bg-blue-800 text-white text-sm font-medium rounded-lg hover:bg-blue-900 transition-colors"
                    onclick="shareOnLinkedIn()">
              <svg class="w-4 h-4 inline mr-1" fill="currentColor" viewBox="0 0 24 24">
                <path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/>
              </svg>
              LinkedIn
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Navigation -->
    <div class="mt-12 flex justify-between items-center">
      <%= link_to forms_path, class: "inline-flex items-center text-gray-600 hover:text-indigo-600 font-medium transition-colors" do %>
        <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18" />
        </svg>
        Back to Forms
      <% end %>
      
      <%= link_to new_from_ai_forms_path, class: "inline-flex items-center text-indigo-600 hover:text-indigo-700 font-medium transition-colors" do %>
        Create Another AI Form
        <svg class="w-4 h-4 ml-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" />
        </svg>
      <% end %>
    </div>
  </div>
</div>

<script>
  function shareOnTwitter() {
    const text = `Just created an amazing form with AI using @AgentForm! 🤖✨ Generated <%= @form.form_questions.count %> questions in seconds. The future of form building is here! #AI #FormBuilder #NoCode`;
    const url = `https://twitter.com/intent/tweet?text=${encodeURIComponent(text)}`;
    window.open(url, '_blank', 'width=600,height=400');
  }

  function shareOnLinkedIn() {
    const text = `Just experienced the future of form building with AgentForm's AI! Generated a complete <%= @form.form_questions.count %>-question form in seconds. This is what intelligent automation looks like. #AI #FormBuilder #Productivity`;
    const url = `https://www.linkedin.com/sharing/share-offsite/?url=${encodeURIComponent(window.location.origin)}&summary=${encodeURIComponent(text)}`;
    window.open(url, '_blank', 'width=600,height=400');
  }
</script>